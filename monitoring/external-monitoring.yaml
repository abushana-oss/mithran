# External Monitoring Configuration

## Uptime Monitoring (UptimeRobot/Pingdom)
monitors:
  - name: "API Health Endpoint"
    url: "https://api.yourdomain.com/health"
    interval: 60  # seconds
    timeout: 30
    regions: ["us-east", "us-west", "eu-central"]
    
  - name: "Database Connectivity"
    url: "https://api.yourdomain.com/health/database"
    interval: 120
    timeout: 45
    
  - name: "Supabase Direct"
    url: "https://iuvtsvjpmovfymvnmqys.supabase.co/rest/v1/"
    interval: 300
    timeout: 30

## Synthetic Monitoring (DataDog/New Relic)
synthetic_tests:
  - name: "Production Process Creation"
    type: "api"
    endpoint: "POST /api/v1/production-planning/processes"
    frequency: "5m"
    locations: ["aws:us-east-1", "aws:eu-west-1", "gcp:us-central1"]
    assertions:
      - status_code: [200, 201]
      - response_time: < 2000ms
      - body_contains: "success"

## Infrastructure Monitoring
prometheus_rules:
  - name: "database_connection_failures"
    query: "rate(database_errors_total[5m]) > 0.1"
    duration: "2m"
    severity: "critical"
    
  - name: "dns_resolution_failures" 
    query: "rate(dns_lookup_failures_total[5m]) > 0.05"
    duration: "1m"
    severity: "warning"

## Alerting Channels
notifications:
  - type: "slack"
    channel: "#ops-alerts"
    escalation_policy: "database-issues"
    
  - type: "pagerduty"
    service_key: "${PAGERDUTY_SERVICE_KEY}"
    escalation_delay: 300  # seconds
    
  - type: "webhook"
    url: "https://hooks.yourdomain.com/alerts"
    headers:
      Authorization: "Bearer ${WEBHOOK_TOKEN}"